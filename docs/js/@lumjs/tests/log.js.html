<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: log.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: log.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
const types = require('@lumjs/core').types;
const {F,S,O,isArray,stringify} = types;

/**
 * A log representing the results of a test.
 * 
 * @property {boolean} ok - Did the test pass.
 * @property {boolean} skipped - Was the test skipped?
 * @property {string} skippedReason - If the test was skipped, why?
 * @property {?string} desc - A short description of the test.
 * @property {*} directive - Special directives describing the test.
 * @property {object} details - Extra information about the test.
 * 
 * @property {*} [details.got] The value that was received in an `is` test.
 * @property {*} [details.wanted] The value that was expectged in an `is` test.
 * @property {*} [details.stringify] If `true` then output the details as JSON.
 * 
 */
class Log 
{
  constructor ()
  {
    this.ok = false;
    this.skipped = false;
    this.skippedReason = '';
    this.desc = null;
    this.directive = null;
    this.details = {};
  }

  /**
   * Output this Log object in the TAP format.
   * 
   * Generally this is never needed to be used by outside code.
   * The `Test.tap()` method uses it when generating a full log.
   * 
   * @param {*} num - The test number.
   * @returns {string} The TAP log.
   */
  tap (num)
  {
    var out;
    if (this.ok)
      out = 'ok ';
    else
      out = 'not ok ';

    out += num;

    if (typeof this.desc === S)
      out += ' - ' + this.desc;

    if (typeof this.directive === S)
      out += ' # ' + this.directive;
    else if (typeof this.directive == O &amp;&amp; this.directive instanceof Error)
      out += ` # ${this.directive.name}: ${this.directive.message}`;
    else if (this.skipped)
      out += ' # SKIP ' + this.skippedReason;

    out += "\n";

    if ('got' in this.details &amp;&amp; 'wanted' in this.details)
    {
      var got = this.details.got;
      var want = this.details.wanted;
      if (this.details.stringify)
      {
        got = stringify(got);
        want = stringify(want);
      }
      out += `#       got: ${got}\n`;
      out += `#  expected: ${want}\n`;
      if (typeof this.details.comparitor === S)
      {
        out += `#        op: ${this.details.comparitor}\n`;
      }
    }

    if ('info' in this.details)
    { // Extended information. Usually an array, but can be whatever.
      const info 
        = isArray(this.details.info) 
        ? this.details.info
        : [this.details.info];

      for (const i in info)
      {
        const line = (typeof info[i] === S) ? info[i] : stringify(info[i]);
        out += `## ${line}\n`;
      }
    }

    return out;
  } // Log.tap()

} // class Log

// Export the class itself.
module.exports = Log;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-@lumjs_tests.html">@lumjs/tests</a></li><li><a href="module-@lumjs_tests_functional.html">@lumjs/tests/functional</a></li><li><a href="module-@lumjs_tests_harness.html">@lumjs/tests/harness</a></li><li><a href="module-@lumjs_tests_test.html">@lumjs/tests/test</a></li></ul><h3>Classes</h3><ul><li><a href="Log.html">Log</a></li><li><a href="module-@lumjs_tests_harness-Harness.html">Harness</a></li><li><a href="module-@lumjs_tests_test-Test.html">Test</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Wed Jul 27 2022 17:13:38 GMT-0700 (Pacific Daylight Saving Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
